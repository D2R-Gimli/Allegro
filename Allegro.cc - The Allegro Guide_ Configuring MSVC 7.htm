<html>

<head>
<link rel="stylesheet" href="style.css" type="text/css">
<title>Allegro.cc - The Allegro Guide: Configuring MSVC 7</title>
</head>

<body>

<h1>The Allegro Guide</h1>

<a href="getting_started.html">General</a> » Windows » MSVC 7 » Using Allegro

<h2>I. Creating a Project</h2>
<p>
Using Allegro with Microsoft Visual Studio is simple once you get the workspace
configured. For most applications, you will want to use a "Win32 Application" and 
link against the optimized library. While writing the code, however, you will
probably want to use the debugging and profiling modes. We are assuming you already
have Allegro already installed for MSVC 7.
</p>

<h3>A. Configuring a Win32 Application</h3>
<p>
If you want to create a game with graphics, then you need to create a 'Win32 Application'
workspace. (<a href="figures/windows-msvc7-use-01.png" target="_blank">figure&nbsp;1</a>)
</p>

<ol>
<li>Open Microsoft Visual Studio .NET</li>
<li>Click on File / New / Project</li>
<li>Choose "visual C++ Projects" / "Win32 Project"</li>
<li>Enter your project Name, choose a Location and hit "OK"</li>
<li>Select "Application Settings" and choose "Empty project"</li>
<li>Hit "Finish"</li>
</ol>

<p>
Your workspace has been set up, but now we need to link to the Allegro library. You 
technically only need to set up the optimized or debugging version, but it's recommended
to set up all three versions of Allegro - including the profiling. Remember that you
must have already built all these versions of Allegro before you can use them! 
</p>

<p>
In order to get to the settings, you will  need to <i>Right-click on the Project Name 
in the "Solution Explorer" and choose "Properties"</i>.
(<a href="figures/windows-msvc7-use-02.png" target="_blank">figure&nbsp;2</a>)
</p>

<ol>
<li>Click "Configuration Manager..."</li>
<li>Select "&lt;New...&gt;" from the "Active Solution Configuration" drop down.</li>
<li>Enter "Profile" in the "Solution Configuration Name".</li>
<li>Hit "OK".</li>
</ol>

<p>
Now that we have all the configurations in place, we must set them up. We need to make the decision now if we
want to statically link or dynamically link. Dymamically linking means that you must distribute the Allegro DLL
along with your files. If you statically link, your executable will be much bigger (the size of the DLL), but you
will not need to distribute the DLL. If you have more than one executable, you should probably link dynamically
to save space. If you want to be able to use both methods, then you can repeat the steps 1-4 from above and add three more 
configurations entitled "Static Release, "Static Profile", and "Static Debug".
</p>

<p>
In short, <b>you only need to do one or the other</b>. If you are not sure, then linking dynamically is the safer
option.
</p>

<h4>1. Dynamically Linking</h4>

<ol>
<b>Debug Build</b>
<li>Under the Configuration drop-down, choose "Debug"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Code Generation"</li>
<li>Select "Multi-threaded Debug DLL" in "Runtime Library"</li>
<li>In the folder tree, choose "Configuration Properties" / "Linker" / "Input"</li>
<li>Enter "alld.lib" in "Additional Dependencies"</li>
<li>Click "Apply"</li>
</ol>

<ol>
<b>Optimized (Release) Build</b>
<li>Under the Configuration drop-down, choose "Release"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Code Generation"</li>
<li>Select "Multi-threaded DLL" in "Runtime Library"</li>
<li>In the folder tree, choose "Configuration Properties" / "Linker" / "Input"</li>
<li>Enter "alleg.lib" in "Additional Dependencies"</li>
<li>Click "Apply"</li>
</ol>

<ol>
<b>Profile Build</b>
<li>Under the Configuration drop-down, choose "Profile"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Code Generation"</li>
<li>Select "Multi-threaded DLL" in "Runtime Library"</li>
<li>In the folder tree, choose "Configuration Properties" / "Linker" / "Input"</li>
<li>Enter "allp.lib" in "Additional Dependencies"</li>
<li>Click "Apply"</li>
</ol>

<h4>2. Statically Linking</h4>

<p>(Note: If you have chosen to configure both dynamic and static links, make sure to select the Static configurations
in the steps below.)</p>

<ol>
<b>Static Debug Build</b>
<li>Under the Configuration drop-down, choose "Debug"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Code Generation"</li>
<li>Select "Multi-threaded Debug DLL" in "Runtime Library"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Preprocessor"</li>
<li>Enter "ALLEGRO_STATICLINK" in "Preprocessor Definitions"</li>
<li>In the folder tree, choose "Configuration Properties" / "Linker" / "Input"</li>
<li>Enter "alld_s.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib ole32.lib dinput.lib ddraw.lib dxguid.lib winmm.lib dsound.lib" in "Additional Dependencies"</li>
<li>Click "Apply"</li>
</ol>

<ol>
<b>Static Optimized (Release) Build</b>
<li>Under the Configuration drop-down, choose "Release"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Code Generation"</li>
<li>Select "Multi-threaded DLL" in "Runtime Library"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Preprocessor"</li>
<li>Enter "ALLEGRO_STATICLINK" in "Preprocessor Definitions"</li>
<li>In the folder tree, choose "Configuration Properties" / "Linker" / "Input"</li>
<li>Enter "alleg_s.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib ole32.lib dinput.lib ddraw.lib dxguid.lib winmm.lib dsound.lib" in "Additional Dependencies"</li>
<li>Click "Apply"</li>
</ol>

<ol>
<b>Static Profile Build</b>
<li>Under the Configuration drop-down, choose "Profile"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Code Generation"</li>
<li>Select "Multi-threaded DLL" in "Runtime Library"</li>
<li>In the folder tree, choose "Configuration Properties" / "C/C++" / "Preprocessor"</li>
<li>Enter "ALLEGRO_STATICLINK" in "Preprocessor Definitions"</li>
<li>In the folder tree, choose "Configuration Properties" / "Linker" / "Input"</li>
<li>Enter "allp_s.lib kernel32.lib user32.lib gdi32.lib comdlg32.lib ole32.lib dinput.lib ddraw.lib dxguid.lib winmm.lib dsound.lib" in "Additional Dependencies"</li>
<li>Click "Apply"</li>
</ol>
<p>
The workspace is entirely configured now! Skip down to the section entitled "Compiling Source Code" to get your
first program compiled.

<h3>B. Configuring a Console Application</h3>
<p>
If you just want to use Allegro for a text console, then you can follow the above instructions, except you
will need to choose "Win32 Console Application" when first creating the project. Also, you will need to define
"USE_CONSOLE" before you include &lt;allegro.h&gt;, as illustrated below.
</p>

<h2>II. Compiling Source Code</h2>

<p>
For the sake of simplicity, we will set up a program from one source file that should display the words "Hello World" in a pop up dialog box. 
</p>

<ol>
<li>Click on "File" / "Add New Item..."</li>
<li>Choose "C++ File", enter the Name, and press "Open"<br><br></li>
<li>Enter the following code:
<pre>
#include &lt;allegro.h&gt;

int main(void)
{
  allegro_init();
  allegro_message("Hello World");
  return 0;
}
END_OF_MAIN();
</pre>
</li>
<li>Compile and Run the program. (CTRL-F5)</li>
</ol>

To select which configuration you want to build, simply choose "Build" / "Configuration Manager" and choose which one to use. Generally,
you will code your project with the Debugging version, test for performance with the Profiling version, and the release with the Release (Optimize)
version.



</body>

</html>